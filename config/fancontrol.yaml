---

# /sys/class/hwmon node, uses the 'name' file content for binding
hwmon:
 - it8665
 - k10temp
 - amdgpu

# Sensor binding
# Sensor types:
# 1. hwmon node, 'type' points to hwmon entry, 'bind' points to the file name which should be read
# 2. shell_cmd type, uses shell command to retrieve sensor data
sensors:
  - cpu: { type: it8665, bind: temp1 }
#  - mb: { type: it8665, bind: temp2 }
#  - wd12: { type: shell_cmd, bind: "hddtemp /dev/sdd | tail -c 6 | head -c -4" }
#  - wd8: { type: shell_cmd, bind: "hddtemp /dev/sdc | tail -c 6 | head -c -4" }

# PWM channel binding
# type: hwmon node entry, defined in 'hwmon' section
# mode: 'dc' - DC mode channel mode, 'pwm' - PWM channel mode
# bind: points to the file name which will be used for control
# minpwm, maxpwm: allowed values range, corresponds to the range of used fan
# fan_stop: boolean option, if true, the fan will be completely stopped
# if temperature is below lowest defined. Default value: false
pwms:
  - cpu_main: { type: it8665, bind: pwm1, mode: dc, minpwm: 110, maxpwm: 255 }
  - cpu_aux: { type: it8665, bind: pwm6, mode: pwm, minpwm: 30, maxpwm: 230 }
  - cha: { type: it8665, bind: pwm2, mode: dc, minpwm: 90, maxpwm: 255 }

# Controller binding
# sensor: Sensor binding entry. Can be multiple, highest temperature will be used as reference
# pwm: PWM channel binding entry. Can be multiple
# mode: control algorithm, possible values:
# 1. two_point - simple 2 point curve transformation
# 2. multi_point - arbitrary amount of approximation points
# 3. pi - proportional-integral control algorithm (not implemented yet)
#
# poll: polling options, can contain:
# 1. time - sampling time in seconds('s' suffix or absent)
#    or milliseconds('ms' suffix), default value = 1s
# 2. ma_samples - amount of samples for moving average sensor reading mode, disabled if not exist
#
# set: special options for selected control algorithm (mode)
# 1. For 'two_point' it contains min and max allowed temperature: 'a', 'b'
# - min temperature maps to the 'minpwm' value
# - max temperature maps to the 'maxpwm' value
#
# 2. For "multi_point' it contains the points array (arbitrary amount of points),
# each point contain temperature and pwm value mapping,
# pwm value is defined in percents between minpwm and maxpwm value, e.g
# if minwm=100, maxpwm=200 the point {50: 30} will declare that at 50C
# the raw pwm value should be 130
#
# 3. For 'pi' it contains:
# temp - desired temperature setting
# p - proportional coefficient
# i - integral coefficient
controllers:
#  - cpu: { sensor: cpu, pwm: { cpu_main, cpu_aux, cha }, mode: two_point,
#      poll: { time: 1s, ma_samples: 8 }, set: { a: 50, b: 78 }
#    }
  - cha1: { sensor: cpu, pwm: cha, mode: pi, poll: { time: 2s, ma_samples: 8 },
      set: { t: 50, kp: 5, ki: 0.1 }
    }
#  - cha2: { sensor: wd4, pwm: cha, mode: multi_point, poll: 30s,
#    set: {{ 40 : 0 }, { 50 : 50 }, { 60 : 100 }}, fan_stop: true
#  }
#   - aux: { sensor: cpu, pwm: cha , mode: two_point, poll: 5s,
#      set: { a: 40, b: 75, off: true }
#     }
#   - cpu_multi: { sensor: cpu, pwm: { cpu_main, cpu_aux, cha }, mode: multi_point,
#      poll: { time: 1s, ma_samples: 8 },
#      set: {{ 40 : 0 }, { 55 : 20 }, { 75 : 100 }}
#    }

# Utility options (not implemented yet)
daemon_conf:
  - mqtt_telemetry: { enable: false, broker: localhost, port: 1883, topic: serv_fanctrl }
